<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<h1 style="text-align:center; margin-top:40px;">Admin Panel</h1>

<div class="container">

    <h2>Add Achievement</h2>

    <input id="ach" placeholder="Enter new achievement" class="input-box">

    <button onclick="addAch()" class="btn-primary">Add Achievement</button>

    <hr style="margin:20px 0;">

    <h2>All Achievements</h2>
    <div id="list" class="achievement-list"></div>

    <button onclick="logout()" class="btn-primary" style="margin-top:25px;">Logout</button>

</div>

<!-- SUPABASE v2 (UMD build) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.5/dist/umd/supabase.js"></script>

<!-- Config -->
<script src="supabase.js"></script>

<script>
/* =====================================================
   SUPABASE CLIENT
===================================================== */
const { createClient } = supabase;
const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* =====================================================
   ADMIN AUTH CHECK
===================================================== */
async function checkAdmin() {
    const { data } = await supabaseClient.auth.getUser();

    if (!data.user) {
        alert("Please login first!");
        window.location.href = "login.html";
        return;
    }

    // Only YOU can access admin
    if (data.user.email !== "umamahe113@gmail.com") {
        alert("You are not authorized to access admin panel!");
        window.location.href = "login.html";
    }
}

checkAdmin();

/* =====================================================
   LOAD ACHIEVEMENTS
===================================================== */
async function loadList() {
    const { data } = await supabaseClient.from("achievements").select("*");

    document.getElementById("list").innerHTML =
        data.map(a => `<p class="achievement-item">â€¢ ${a.text}</p>`).join("");
}

loadList();

/* =====================================================
   ADD ACHIEVEMENT
===================================================== */
async function addAch() {
    const text = document.getElementById("ach").value.trim();

    if (!text) {
        alert("Please enter text!");
        return;
    }

    await supabaseClient.from("achievements").insert([{ text }]);

    document.getElementById("ach").value = "";

    loadList();
}

/* =====================================================
   LOGOUT
===================================================== */
async function logout() {
    await supabaseClient.auth.signOut();
    window.location.href = "login.html";
}
</script>

</body>
</html>
